# PE文件位数检测工具

一个简单的Windows批处理脚本，用于快速检测PE文件（如.exe或.dll）是32位还是64位。该工具自动处理依赖安装，支持命令行参数和交互式输入。

`readme.md` 文件由DeepSeek创建。

## 功能特点

- **自动依赖管理**：检查并自动安装所需的Python库（pefile）。
- **灵活输入方式**：支持通过命令行参数或交互式输入指定文件路径。
- **临时文件清理**：运行后自动删除临时生成的Python脚本。
- **错误处理**：提供友好的错误提示，如文件未找到或非PE文件。

## 依赖要求

- **操作系统**：Windows（批处理脚本仅适用于Windows环境）
- **Python**：需要安装Python 3.x（建议最新版本），并确保Python已添加到系统PATH环境变量中
- **编码支持**：脚本使用GBK编码，建议在中文Windows环境下运行以避免乱码

## 使用方法

### 基本运行方式

1. **下载脚本**：将 `PE_Check_GBK.bat` 保存到本地。
2. **直接运行**：
   - 双击批处理文件，根据提示输入目标文件的完整路径。
   - 示例输入：`C:\Program Files\example.exe`
3. **命令行运行**：
   - 将文件拖放到批处理文件上（自动作为参数传递）。
   - 或在命令行中执行：`PE_Check_GBK.bat "C:\路径\文件.exe"`

### 运行示例

```
请输入需要检测的exe/dll文件的完整路径并按回车: C:\test\program.exe
这是一个64位的文件。
按任意键继续...
```

或通过命令行参数：
```
PE_Check_GBK.bat "C:\test\program.dll"
```

又或是直接将exe文件拖拽到BAT文件上释放。

## 工作原理

1. 脚本首先检查Python的pefile库是否已安装，若未安装则自动通过pip安装。
2. 动态生成一个临时Python脚本（tmp.py），使用pefile库解析PE文件头的Magic值：
   - `0x20b` 表示64位文件
   - `0x10b` 表示32位文件
3. 执行检测并输出结果，最后清理临时文件。

## 注意事项

- 如果系统未安装Python，脚本将报错。请提前从[Python官网](https://www.python.org/downloads/)下载并安装。
- 文件路径中包含空格时，建议使用引号包裹路径（如`"C:\Program Files\app.exe"`）。
- 该工具仅适用于标准PE文件（如EXE、DLL），不支持其他格式。

## 许可证

本项目采用CC0 1.0通用公共领域贡献许可证。这意味着作者放弃所有版权，将作品置于公共领域。您可以自由复制、修改、分发和商业使用，无需署名。有关详细信息，请参阅[CC0许可证全文](https://creativecommons.org/publicdomain/zero/1.0/)。

## 贡献

欢迎提交Issue或Pull Request来改进工具！
